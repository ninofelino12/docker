<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css" rel="stylesheet">
  <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js" defer></script>

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <style>
    #loading-container,
    #loadingMessage {
      display: none;
    }

    .loader {
      border: 4px solid #f3f3f3;

      border-top: 4px solid #3498db;

      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 2s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }
  </style>
  <script>
    const loadJsonLink = document.getElementsByClassName('a')
    const outputDiv = document.getElementById("output");

    loadJsonLink.addEventListener("click", async () => {
 
      try {
        const response = await fetch("http://localhost"); // Replace with your actual JSON URL

        if (!response.ok) {
          throw new Error(`HTTP error ${response.status}`);
        }

        const jsonData = await response.json();
        outputDiv.textContent = JSON.stringify(jsonData, null, 2); // Pretty-print JSON
      } catch (error) {
        console.error("Error fetching JSON:", error);
        outputDiv.textContent = "Error loading JSON data.";
      }
    });
    function clearCache() {
  // Attempt to clear cache using available mechanisms:
  if ('caches' in window) {
    caches.keys().then(cacheNames => {
      return Promise.all(cacheNames.map(cacheName => caches.delete(cacheName)));
    }).then(() => {
      // Cache cleared successfully
      console.log('Cache cleared!');
      // Optionally reload the page:
      window.location.reload();
    });
  } else {
    // Fallback to reloading the page (not as effective as clearing cache)
    window.location.reload();
  }
}
  </script>
</head>


<body>

  <button onclick="clearCache()">Clear Cache</button>
  <div class="search-bar">
    <input type="text" id="search-input" placeholder="Search...">
    <select id="search-type">
      <option value="all">Semua</option>
      <option value="product">Produk</option>
      <option value="category">Kategori</option>
    </select>
  </div>

  <button id="loadButton" onclick="loadJSON('http://127.0.0.1:5000/table')">Load XML</button>
  <pre id="xmlData"></pre>

  <script>
    window.onload = loadData;
    async function loadJSON(url) {
      document.querySelector("#loadButton").style.cursor = "wait";
      document.getElementById("loading-container").style.display = "block";
      var progressBar = document.getElementById("loading-progress-bar");
      progressBar.style.width = "0%";

      try {
        const response = await fetch(url);

        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const data = await response.text();
        document.getElementById('xmlData').innerHTML = data;
        document.querySelector("#loading-button").style.cursor = "default";
        progressBar.style.width = (100 / data.length) + "%";
        document.getElementById("loading-container").style.display = "none";
        return data;
      } catch (error) {
        console.error('Error loading JSON:', error);
        throw error; // Re-throw to allow further handling
      }
    }


  </script>
  <div id="loadingMessage"></div>

  <div id="menu">
    {{script | safe}}
  </div>
  <div class="loader"></div>
  <div id="loading-container">
    <div id="loading-spinner"></div>
    <div id="loading-progress-bar"></div>
  </div>
  <ul id="isi" class="cards">

  </ul>
  <div>
    {{name|safe}}
  </div>

  <div class="crd">
    {{content|safe}}
  </div>



</body>


</html>